{
  "name": "Audit_Api",
  "x-fp-version": "2.7.0",
  "type": "record",
  "fields": [
    {
      "name": "EVENT_TM",
      "type": {
        "type": "string",
        "logicalType" : "datetime",
        "arg.properties": {
          "options" : [ "2023-12-18T16:18:05Z", "2023-12-18T16:19:05Z", "2023-12-18T16:20:05Z", "2023-12-18T16:21:05Z", "2023-12-18T16:22:05Z", "2023-12-18T16:23:05Z" ]
        }
      }
    },
    {
      "name": "YEAR",
      "type": {
        "type": "int",
        "arg.properties": {
          "options" : [ 2023 ]
        }
      }
    },
    {
      "name": "MONTH",
      "type": {
        "type": "int",
        "arg.properties": {
            "options" : [ 12 ]
        }
      }
    },
    {
      "name": "DAY",
      "type": {
        "type": "int",
        "arg.properties": {
            "options" : [ 18 ]
        }
      }
    },
    {
      "name": "HOUR",
      "type": {
        "type": "int",
        "arg.properties": {
            "options" : [ 16 ]
        }
      }
    },
    {
      "name": "ID",
      "type": {
        "type": "string",
        "arg.properties": {
          "kind": "uuid"
        }
      }
    },
    {
      "name": "USER_INFO",
      "type": [
        "null",
        {
          "type": "record",
          "name": "USER_INFO_RECORD",
          "fields" : [
            {
              "name": "USER_ID",
              "type": {
                "type": "string",
                "x-fp-user-id": true,
                "arg.properties": {
                  "options" : [ "user1", "user2" ]
                }
              }
            },
            {
              "name": "IDENTIFIER",
              "type": {
                "type": "array",
                "items": {
                  "type": "record",
                  "name": "IDENTIFIER_RECORD",
                  "fields": [
                    {
                      "name": "value",
                      "type": {
                        "type": "string",
                        "arg.properties": {
                          "options" : [ "value1", "value2" ]
                        }
                      }
                    },
                    {
                      "name": "type",
                      "type": {
                        "type": "string",
                        "arg.properties": {
                          "options" : [ "type1", "type2" ]
                        }
                      }
                    }
                  ]
                }
              }
            },
            {
              "name": "AUTHORIZATION_ID",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "authid1", "authid2" ]
                }
              }
            },
            {
              "name": "AUTHENTICATION_ID",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "authid3", "authid4" ]
                }
              }
            },
            {
              "name": "ACR",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "acr1", "acr2" ]
                }
              }
            }
          ]
        }
      ]
    },
    {
      "name": "URL",
      "type": {
        "type": "string",
        "arg.properties": {
            "options" : [ "https://api.shared-azure.baikalplatform.es/admin/v2/datasets", "https://api.shared-azure.baikalplatform.es/admin/v2/apps" ]
        }
      }
    },
    {
      "name": "API_NAME",
      "type": {
        "type": "string",
        "arg.properties": {
            "options" : [ "admin", "apps" ]
        }
      }
    },
    {
      "name": "HTTP_VERB",
      "type": {
        "name": "HTTP_VERB",
        "type": "enum",
        "arg.properties": {
          "options": [ "GET", "POST" ]
        },
        "symbols": [ "GET", "HEAD", "POST", "PUT", "DELETE", "CONNECT", "OPTIONS", "TRACE", "PATCH" ]
      }
    },
    {
      "name": "CLIENT_ID",
      "type": {
        "type": "string",
        "arg.properties": {
          "options" : [ "app1", "app2" ]
        }
      }
    },
    {
      "name": "MAY_ACT_SUB",
      "type": [
        "null",
        {
          "type": "string",
          "arg.properties": {
            "options": [ "may_act_sub1",  "may_act_sub2" ]
          }
        }
      ]
    },
    {
      "name": "JTI",
      "type": {
        "type": "string",
        "arg.properties": {
          "options": [ "jti1", "jti2" ]
        }
      }
    },
    {
      "name": "CONSENTS",
      "type": {
        "type" : "array",
        "items" : {
          "type" : "string",
            "arg.properties": {
                "options" : [ "consent1", "consent2" ]
            }
        }
      }
    },
    {
      "name": "SCOPES",
      "type": {
        "type" : "array",
        "items" : {
          "type" : "string",
          "arg.properties": {
            "options" : [ "scope1", "scope2" ]
          }
        }
      }
    },
    {
      "name": "PURPOSES",
      "type": {
        "type" : "array",
        "items" : {
          "type" : "string",
          "arg.properties": {
            "options" : [ "purpose1", "purpose2" ]
          }
        }
      }
    },
    {
      "name": "ACTIVATED_ROLES",
      "type": {
        "type" : "array",
        "items" : {
          "type" : "string",
          "arg.properties": {
            "options" : [ "role1", "role2" ]
          }
        }
      }
    },
    {
      "name": "OWNER",
      "type": [
        "null",
        {
          "type": "string",
          "arg.properties": {
            "options" : [ "owner1", "owner2" ]
          }
        }
      ]
    },
    {
      "name": "LATENCY",
      "type": {
        "type": "long",
        "arg.properties": {
          "min": "0",
          "max": "1000"
        }
      }
    },
    {
      "name": "REQUEST_SIZE",
      "type": {
        "type": "long",
        "arg.properties": {
          "min": "0",
          "max": "1000"
        }
      }
    },
    {
      "name": "RESPONSE_SIZE",
      "type": {
        "type": "long",
        "arg.properties": {
          "min": "0",
          "max": "1000"
        }
      }
    },
    {
      "name": "STATUS_CODE",
      "type": {
        "type": "int",
        "arg.properties": {
          "options" : [ 200, 201, 202, 400, 500 ]
        }
      }
    },
    {
      "name": "BODY",
      "type": [
        "null",
        {
          "type": "string",
          "arg.properties": {
            "options" : [ "<html><head><title>body1</title></head></html>", "<html><head><title>body2</title></head></html>" ]
          }
        }
      ]
    },
    {
      "name": "CORRELATOR",
      "type": [
        "null",
        {
          "type": "string",
          "arg.properties": {
              "options" : [ "correlator1", "correlator2" ]
          }
        }
      ]
    },
    {
      "name": "MAY_ACT",
      "type": [
        "null",
        {
          "type": "record",
          "name": "MAY_ACT_RECORD",
          "fields": [
            {
              "name": "SUB",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "sub1", "sub2" ]
                }
              }
            },
            {
              "name": "OPERATOR_ID",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "opid1", "opid2" ]
                }
              }
            },
            {
              "name": "OPERATOR_TYPE",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "optype1", "optype2" ]
                }
              }
            },
            {
              "name": "OPERATOR_ROLES",
              "type": {
                "type": "array",
                "name": "OPERATOR_ROLES_RECORD",
                "items": {
                  "type": "record",
                  "name": "OPERATOR_ROLES_RECORD",
                  "fields": [
                    {
                      "name": "ROLE_ID",
                      "type": {
                        "type": "string",
                        "arg.properties": {
                          "options" : [ "roleid1", "roleid2" ]
                        }
                      }
                    },
                    {
                      "name": "ROLE_TYPE",
                      "type": {
                        "type": "string",
                        "arg.properties": {
                          "options" : [ "roletype1", "roletype2" ]
                        }
                      }
                    }
                  ]
                }
              }
            },
            {
              "name": "LOA",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "loa1", "loa2" ]
                }
              }
            },
            {
              "name": "OPERATOR_AMR",
              "type": {
                "type": "string",
                "arg.properties": {
                  "options" : [ "opamr1", "opamr2" ]
                }
              }
            },
            {
              "name": "OPERATOR_SCOPES",
              "type": {
                "type": "array",
                "items": {
                    "type": "string",
                    "arg.properties": {
                    "options" : [ "opscope1", "opscope2" ]
                    }
                }
              }
            }
          ]
        }
      ]
    },
    {
      "name": "CLIENT_IP_ADDRESS",
      "type": [
        "null",
        {
          "type": "string",
          "logicalType" : "ipv4",
          "arg.properties": {
              "options" : [ "193.168.10.1", "194.205.20.2" ]
          }
        }
      ]
    }
  ]
}
